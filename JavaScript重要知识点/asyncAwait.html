<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
    /**
     * @Author: YXS
     * @Description: promise 加载图片
     */
     function loadImg(src) {
         return new Promise((resolve, reject) => {
             const img = document.createElement('img')
             img.onload = () => {
                 resolve(img)
             }
             img.onerror = () => {
                 const err = new Error(`图片加载失败 ${src}`)
                 reject(err)
             }
             img.src = src
         })
     }
     const url1 = 'https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcSYLdCiAcioji50WBCXLg7B5HBq1Di3YJop4Q&usqp=CAU';
     const url2 = 'https://pic3.zhimg.com/v2-5d14881b10f6be7dbf0a992ae271179a_b.jpg';
    
    // 使用 async await
    // (async function() {
    //     // 同步的写法执行异步的代码
    //     const img1 = await loadImg(url1)
    //     console.log(img1)
    //     const img2 = await loadImg(url2)
    //     console.log(img2)
    // })();

    // async function loadImg1() {
    //     const img1 = await loadImg(url1)
    //     return img1
    // }
    // async function loadImg2() {
    //     const img2 = await loadImg(url2)
    //     return img2
    // }
    // // await 后面跟 async 函数
    // !(async function(){
    //     const img1 = await loadImg1()
    //     console.log(img1)

    //     const img2 = await loadImg2()
    //     console.log(img2)
    // })()

    //  使用promise
    //  loadImg(url1).then(img => {
    //      console.log('then one ——', img.width)
    //      return loadImg(url2)
    //  }).then(img2 => {
    //      console.log('then two ——', img2.width)
    //  }).catch(err => {
    //      console.log('catch ——',err)
    //  }).finally((res) => {
    //      console.log('finally ——', res)
    //  })

    // async function fn1() {
    //     return Promise.resolve(100)
    // }
    // const res1 = fn1()
    // console.log('res1', res1) // Promise 对象
    // (async function(){
    //     const p = Promise.resolve(300)
    //     p.then(res => {
    //         console.log('res:', res)
    //     })
    //     const data = await p // await 相当于 Promise then
    //     console.log('data:', data)
    //     const data1 = await 400
    //     console.log('data1', data1)
    // })()

    (async function() {
        const p = Promise.reject('报错了报错了')
        p.then(res => {
            console.log('then res：',res)
        }).catch(error => {
            console.log('catch error：', error)
        })
        try {
            const res = await p
            console.log('res：',res)
        } catch (error) {
            console.log('error：', error)
        }
    })()
    </script>
</body>
</html>
<!--
 * @Author: YXS
 * @Date: 2020-08-06 14:36:27
 * @LastEditors: YXS
 * @LastEditTime: 2020-08-07 09:54:52
 * @Description:
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        .div {font-size: .3rem}
        .span {display: block; width: 100%; height: 1rem; border: 1px solid royalblue;}
    </style>
</head>
<body>
    <div class="div">测试</div>
    <span class="span"></span>
    <script>
        // 获取 dpr
        var docEl = document.documentElement,
            viewportEl = document.querySelector('meta[name="viewport"]'),
            dpr = window.devicePixelRatio || 1; // 获取像素比
        // 设置 dpr，只能为 1，2，3
        dpr = dpr >= 3 ? 3 : (dpr >= 2 ? 2 : 1)
        // 设置缩放比例
        var scale = 1 / dpr
        // 缩放比例生成 content
        var content = 'width=device-width,initial-scale='+ scale +',user-scalable=no'
        // 若有 meta 为 viewport 属性，则设置这条 meta 的 content，若没有，则重新生成一个并且设置 content
        if (viewportEl) {
            viewportEl.setAttribute('content', content)
        } else {
            viewportEl = document.createElement('meta')
            viewportEl.setAttribute('name', 'viewport')
            viewportEl.setAttribute('content', content)
            document.head.appendChild(viewportEl)
        }
        var maxWidth = 1024, // 设置最大屏
            minwidth = 320, // 设置最小屏
            windowWidth = docEl.getBoundingClientRect().width || window.innerWidth;
        // 若超过最大宽度，就缩放到最大宽度为止，这里的 dpr 表示缩放比例，由于自动设置了缩放比例，改变了原有的像素比，所以需要除去 dpr 后再进行比较
        if (maxWidth && (windowWidth / dpr >= maxWidth)) {
            windowWidth = maxWidth * dpr
        } else if (minwidth && (windowWidth / dpr <= minwidth)) {
            // 若小于最小宽度，就缩放到最小宽度为止
            windowWidth = minwidth * dpr
        }
        var RootFontSize = windowWidth / 750 * 100;
        document.getElementsByTagName("html")[0].style.fontSize = RootFontSize + "px";
    </script>
</body>
</html>